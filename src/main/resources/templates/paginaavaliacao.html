<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title th:text="'Avaliacao de ' + ${avaliacao.titulo}"> Avaliação</title>
		<meta name='viewport' content='width=device-width, initial-scale=1'>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css">
		<link rel="stylesheet" href="/image/css/stylePaginaItem.css">
		<link rel="stylesheet" href="/image/headers/assets/css/styleheader.css">
		<link rel="stylesheet" href="/image/headers/assets/css/style.css">
		<link rel="stylesheet" href="/image/css/styleAvaliacao.css">
		<link href='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css' rel='stylesheet'>
		
		<script src="https://kit.fontawesome.com/458e90fb96.js" crossorigin="anonymous"></script>
		<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
		<script type='text/javascript' src='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js'></script>
		<script src="https://kit.fontawesome.com/458e90fb96.js" crossorigin="anonymous"></script>
		<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
		<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
	</head>
	<body oncontextmenu='return false' class='snippet-body'>
	
	<!-- HEADER -->
	
		<div class="header-blue">
			<nav class="navbar navbar-dark navbar-expand-md navigation-clean-search">
				<div class="container">
					<a class="navbar-brand" href="#">PPADS</a>
					<button class="navbar-toggler" data-toggle="collapse" data-target="#navcol-1">
						<span class="sr-only">Toggle navigation</span>
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse" id="navcol-1">
						<ul class="nav navbar-nav">
							<li class="nav-item" role="presentation">
								<a class="nav-link" href="/indexmembro">Sugestões para você</a>
							</li>
							<li class="dropdown">
								<a class="dropdown-toggle nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" href="#">Cadastrar novo item</a>
								<div class="dropdown-menu" role="menu">
									<a class="dropdown-item" role="presentation" href="/cadastrofilme">Cadastrar filme</a>
									<a class="dropdown-item" role="presentation" href="/cadastrolivro">Cadastrar livro</a>
									<a class="dropdown-item" role="presentation" href="/cadastroserie">Cadastrar série</a>
								</div>
							</li>
						</ul>
						<form class="form-inline mr-auto" th:action="@{/pesquisar}" method="post">
							<div class="form-group">
								<label for="search-field">
									<i class="fa fa-search"></i>
								</label>
								<input class="form-control search-field" type="search" name="pesquisa" id="search-field">
							</div>
						</form>
						<a class="btn1 btn-light action-button" th:href="@{/perfilmembro/{username}(username=${user.username})}">Meu perfil</a>
					</div>
				</div>
			</nav>
		</div>
		
		<!-- FIM DO HEADER -->
		
		<!-- COMENTÁRIOS -->
		
		<div class="container mx-auto mt-4">
			<h3 class="card-title" th:if="${membro!='eu'}">Avaliação de<a th:href="@{/perfilmembro/{username}(username=${avaliacao.username})}"> <span th:text="${avaliacao.nome}"></span></a> sobre <a th:href="@{/paginaitem/${avaliacao.idItem}}"><span th:text="${avaliacao.titulo}">nome do item</span></a></h3>
			<h3 th:if="${membro=='eu'}" class="card-title">Sua avaliação de <a th:href="@{/paginaitem/${avaliacao.idItem}}"><span th:text="${avaliacao.titulo}">nome da midia</span></a></h3>
			
			<h4 class="card-subtitle-individual">Nota (0 a 10): <span th:text="${avaliacao.nota}"></span></h4>
			<h4 class="card-subtitle-individual" th:text="${avaliacao.descricao}"></h4>

			<h6 class="card-subtitle-individual em">Quantidade atual de joinhas: <span th:text="${avaliacao.numJoinha}"></span></h6>
			
			<div th:if="${membro=='eu'}">	
				<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#form">Alterar avaliação</button>							
			</div>	
			<h3>Comentários nessa avaliação: </h3>
			<h4 th:if="${l5==0}">Ainda não há comentários nessa avaliação.</h4>
			
			<div class="container cont-borda" th:if="${l5!=0}" th:each="c : ${avaliacao.comentarios}">
				<h4>Comentário de <span th:text="${c.avaliacao.titulo}"></span></h4>	
				<h5 th:text="${c.descricao}"></h5>
				<div th:if="c.idUsuario==user.id">
					<form th:action="@{/deletarcomentario/{id}(id=${c.id})}" method="post"> 
		       		 		<input type="submit" value="apagar comentario" />
		   			</form>
		   		</div>
			</div>
		</div>
		
		<!-- FIM DOS COMENTÁRIOS -->
	
		<!--p>Membro: <span th:text="${avaliacao.username}">Username</span></br> </p>
					
					<h5>Nota (0 a 10): <span th:text="${avaliacao.nota}"></span></h5>
					<h5 th:text="${avaliacao.descricao}"></h5>
					<em>Quantidade atual de joinhas: <span th:text="${avaliacao.numJoinha}"></span></em>
		      		<h5>Comentarios</h5>
		      		<dl th:each="c : ${avaliacao.comentarios}">
		      		<span th:text="${#lists.size(c)}"></span>
		      		 	<dt th:if="${#lists.size(c) > 0}">
		      				<p>Comentario: <span th:text="${c.descricao}">descicao</span></p>
		      			</dt>
		      		</dl>
		
		<div th:if="${membro=='eu'}">
			<form th:action="@{/deletaravaliacao/{id}(id=${avaliacao.id})}" method="post">
			<!-- Implementar javascript check de confirmação 
		       		 	<input type="submit" value="apagar avaliacao" />
		   	</form>
		   	
		   	<form th:action="@{/updateAvaliacao/{id}(id=${avaliacao.id})}" method="post">
			<!-- Implementar javascript check de confirmação 
		       		 	<input type="submit" value="apagar avaliacao" />
		   	</form>
		</div-->
		
		
		<!-- EDITAR AVALIAÇÃO 
		<script>
		function criar(frm){
			console.log(frm.nota.value);
			if(frm.nota.value==null){
				frm.nota.value=0;
			}
		}
		
		</script>
			-->
		<div class="modal fade" id="form" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
					<div class="text-right cross">
						<a class = "btn-exit" th:href="@{/paginaavaliacao/{id}(id=${avaliacao.id})}"><i class="fas fa-times"></i></a>
					</div>
					<div class="card-body text-center"> 
						<img src=" https://i.imgur.com/d2dKtI7.png" height="100" width="100">
						<div class="comment-box text-center">
							<form action="#" th:action="@{/updateAvaliacao/{id}(id=${avaliacao.id})}" method="post" name="cadAval" >
								<h4>Alterar sua avaliação sobre <span th:value="${Item.titulo}">isso</span>?</h4>
								<div class="rating"> 
									<input type="radio" class="rating" name="nota" value="10" id="10"><label for="10"><i class="far fa-heart"></i></label> 
									<input type="radio" class="rating" name="nota" value="9" id="9"><label for="9"><i class="far fa-heart"></i></label>
									<input type="radio" class="rating" name="nota" value="8" id="8"><label for="8"><i class="far fa-heart"></i></label> 
									<input type="radio" class="rating" name="nota" value="7" id="7"><label for="7"><i class="far fa-heart"></i></label> 
									<input type="radio" class="rating" name="nota" value="6" id="6"><label for="6"><i class="far fa-heart"></i></label> 
									<input type="radio" class="rating" name="nota" value="5" id="5"><label for="5"><i class="far fa-heart"></i></label> 
									<input type="radio" class="rating" name="nota" value="4" id="4"><label for="4"><i class="far fa-heart"></i></label> 
									<input type="radio" class="rating" name="nota" value="3" id="3"><label for="3"><i class="far fa-heart"></i></label> 
									<input type="radio" class="rating" name="nota" value="2" id="2"><label for="2"><i class="far fa-heart"></i></label> 
									<input type="radio" class="rating" name="nota" value="1" id="1"><label for="1"><i class="far fa-heart"></i></label>
								</div>
								<div class="comment-area"> 
									<textarea class="form-control" name= "descricao" placeholder="Descreva o que achou..." rows="4"></textarea> 
								</div>
								<div class="text-center mt-4">
									<button value = "input" class="btn btn-success send px-5" th:href="@{/updateAvaliacao/{id}(id=${avaliacao.id})}" method="post">Alterar <i class="fas fa-upload"></i></button>
									
																	 
								</div>
							</form>
							<form th:action="@{/deletaravaliacao/{id}(id=${avaliacao.id})}" method="post">
										<button value = "input" class="btn btn-success send px-5">Deletar <i class="far fa-trash-alt"></i></button>	
							</form>	
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<!-- FIM DA EDIÇÃO DE AVALIAÇÃO -->
		
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.5.2/umd/popper.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>   	
	</body>
</html>